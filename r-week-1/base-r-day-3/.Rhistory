file.copy(from = "/project/shared/r/1_r_data_science/3-stats-pca-cluster/template.Rmd", to = ".")
knitr::opts_chunk$set(echo = TRUE)
```data(iris)
```data(iris)
```data(iris)
ata(iris
data(iris)
head(iris
head(iris)
head(iris)
iris_features <-
head(iris_features)
head(iris)
data(iris)
head(iris)
data(iris)
head(iris)
data(iris)
head(iris)
iris_features <- iris[, 1:4]]
iris_features <- iris[, 1:4]
head(iris_features)
pca_iris <- prcomp(x, center = TRUE, scale = TRUE )
pca_iris <- prcomp(x, center = TRUE, scale. = TRUE )
pca_iris <- prcomp(iris_features, center = TRUE, scale. = TRUE )
pca_iris
pca_iris
pca_iris$rotation[1:4, ]
pca_iris$x
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"]  )
plot(x = pca_iris$x[,"PC2"], y = pca_iris$x[,"PC1"]  )
plot(x = pca_iris$x[,"PC2"], y = pca_iris$x[,"PC1"] , col = iris$Species )
plot(x = pca_iris$x[,"PC2"], y = pca_iris$x[,"PC1"] , col = iris$Sepal.Length )
plot(x = pca_iris$x[,"PC2"], y = pca_iris$x[,"PC1"] , col = iris$Species )
pca_iris$x
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col = iris$Species )
pca_iris$sdev
explained_variance_ratio <- (pca_iris$sdev^2)/ sum(pca_iris$sdev^2)
explained_variance_ratio
barplot(explained_variance_ratio )
pca_iris
summary(pca_iris)
pca_iris
summary(pca_iris)
dist_iris <- dist(t(assay(iris_features, "logcounts")[keep_rows, ]) )
dist_iris <- dist(t(assay(iris_features, "logcounts")[keep_rows, ]))
dist_iris <- dist(t(assay(iris_features, "logcounts")[keep_rows, ]))
dist_iris <- dist(iris_features, method = "euclidean", diag = FALSE, upper=FALSE, p=2)
hclust_iris_ward <- hclust(dist_iris, "complete", members = NULL )
hclust_iris_ward
plot(hclust_iris_ward )
plot(hclust_iris_ward )
plot(hclust_iris_ward, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
iris_hclust_ward_labels <- cutree(hclust_iris_ward, h = 3 )
iris_hclust_ward_labels
iris_hclust_ward_labels <- cutree(hclust_iris_ward, k = 3 )
iris_hclust_ward_labels
dist_iris <- dist(iris_features, method = "euclidean", diag = FALSE, upper=FALSE, p=2)
hclust_iris_ward <- hclust(dist_iris, "ward.D2", members = NULL )
hclust_iris_ward
plot(hclust_iris_ward, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
iris_hclust_ward_labels <- cutree(hclust_iris_ward, k = 3 )
iris_hclust_ward_labels
# complete
hclust_iris_complete <- hclust(dist_iris, "complete", members = NULL )
iris_hclust_complete_labels <- cutree(hclust_iris_complete, k =3 )
iris_hclust_complete_labels
# average
hclust_iris_average <- hclust(dist_iris, "average", members = NULL  )
iris_hclust_average_labels <- cutree(hclust_iris_average, k =3 )
iris_hclust_average_labels
# single
hclust_iris_single <- hclust(dist_iris, "single", members = NULL   )
iris_hclust_single_labels <- cutree(hclust_iris_single, k=3 )
iris_hclust_single_labels
par(mfrow = c(2, 2))
plot(hclust_iris_ward, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
plot(hclust_iris_complete, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
plot(hclust_iris_average, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
plot(hclust_iris_single, labels = NULL, hang =0.1, check = TRUE, axes = TRUE, frame.plot=FALSE, ann=TRUE, main ="Cluster Dendrogram", sub =NULL, xlab=NULL, ylab = "Height" )
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col = iris$Species )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_ward )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_complete )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_average )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_single  )
par(mfrow = c(1, 1))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col = iris$Species )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_ward )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_ward_labels )
= pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_ward_labels
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =hclust_iris_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
par(mfrow = c(2, 2))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete )
par(mfrow = c(2, 2))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
palette(c("red", "blue", "green")
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
par(mfrow = c(2, 2))
palette(c("red", "blue", "green")
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
par(mfrow = c(2, 2))
palette(c("red", "blue", "green"))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
par(mfrow = c(3, 2))
palette(c("red", "blue", "green"))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris$species)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
par(mfrow = c(3, 2))
palette(c("red", "blue", "green"))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris$Species)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris$Species)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
par(mfrow = c(3, 2))
palette(c("red", "blue", "green"))
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris$Species)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_ward_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_complete_labels)
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_average_labels )
plot(x = pca_iris$x[,"PC1"], y = pca_iris$x[,"PC2"] , col =iris_hclust_single_labels  )
par(mfrow = c(1, 1))
table(iris_hclust_ward_labels, iris$Species)
